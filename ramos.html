<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Show do Milh√£o ‚Äî Ramos do Cooperativismo (Responsivo)</title>
  <style>
    :root{
      --bg:#0b1020; --panel:#121939; --ink:#eaf0ff; --muted:#a9b3d5; --accent:#00e1ff; --accent-2:#8b5cf6; --danger:#ff5b5b; --success:#22c55e; --gold:#f9c846;
      --safe-top: env(safe-area-inset-top); --safe-bottom: env(safe-area-inset-bottom);
      --radius:16px; --gap:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,Helvetica,sans-serif; color:var(--ink);
      background:radial-gradient(1200px 600px at 10% -10%, #1c2560 0%, #0b1020 55%), radial-gradient(1200px 800px at 120% 120%, #2a1040 0%, #0b1020 60%);
      display:flex; align-items:stretch; justify-content:center; padding:clamp(8px,1.8vw,16px);
    }
    .app{width:min(1100px, 100%); display:flex; flex-direction:column; gap:var(--gap);}
    header{
      background:linear-gradient(90deg, rgba(0,225,255,.2), transparent 30%, rgba(139,92,246,.2) 70%, transparent);
      border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); padding:12px clamp(10px,2.2vw,20px);
      display:flex; align-items:center; justify-content:space-between; gap:10px; backdrop-filter: blur(6px);
    }
    .brand{display:flex; align-items:center; gap:10px; min-width:0}
    .logo{font-weight:900; letter-spacing:.4px; font-size:clamp(16px,2.6vw,20px); white-space:nowrap}
    .logo .medal{font-size:clamp(18px,2.6vw,22px); color:var(--gold)}
    .sub{color:var(--muted); font-size:clamp(11px,2.2vw,13px); overflow:hidden; text-overflow:ellipsis; display:none}

    .layout{display:grid; grid-template-columns: 1.15fr .85fr; gap:var(--gap); align-items:start}
    @media (max-width: 900px){.layout{grid-template-columns:1fr}}

    .card{background:var(--panel); border:1px solid rgba(255,255,255,.06); border-radius:var(--radius); box-shadow:0 10px 30px rgba(0,0,0,.35)}

    .play{padding:clamp(12px,2.4vw,18px)}
    .status{display:flex; flex-wrap:wrap; justify-content:space-between; align-items:center; gap:8px; margin-bottom:8px}
    .lifelines{display:flex; gap:8px; flex-wrap:wrap}
    .lifelines button,
    .controls button,
    #ladderToggle{
      background:#0f1533; color:var(--ink); border:1px solid rgba(255,255,255,.08); padding:10px 12px; border-radius:12px; cursor:pointer; font-weight:700; font-size:clamp(13px,2.6vw,14px);
      display:flex; align-items:center; gap:8px; transition:.2s transform, .2s background;
      touch-action:manipulation; -webkit-tap-highlight-color: transparent;
    }
    .lifelines button:hover, .controls button:hover, #ladderToggle:hover{transform:translateY(-1px); background:#111a44}
    .lifelines button:disabled{opacity:.45; cursor:not-allowed; transform:none}

    .question{background:linear-gradient(180deg,#0f1a4d,#0c1333); border:1px solid rgba(255,255,255,.08); border-radius:14px; padding:clamp(12px,2.4vw,16px); font-size:clamp(16px,2.8vw,20px); font-weight:800; line-height:1.35;}
    .meta{margin-top:6px; color:var(--muted); font-size:clamp(11px,2.2vw,12px)}

    .answers{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:12px}
    @media (max-width:640px){.answers{grid-template-columns:1fr}}
    .answers button{
      text-align:left; padding:clamp(12px,3.5vw,14px); border-radius:12px; background:#0e1430; color:var(--ink); border:1px solid rgba(255,255,255,.08); cursor:pointer;
      font-size:clamp(14px,3.2vw,15px); font-weight:700; line-height:1.3;
      display:flex; gap:10px; align-items:flex-start; transition:.2s transform, .2s background; min-height:44px;
    }
    .answers button .badge{background:#141c4d; color:#b8c3ff; border:1px solid rgba(255,255,255,.12); border-radius:8px; padding:3px 8px; font-size:clamp(12px,2.8vw,13px); font-weight:900;}
    .answers button:hover{transform:translateY(-1px); background:#121a40}
    .answers button.correct{background:rgba(34,197,94,.12); border-color:rgba(34,197,94,.5)}
    .answers button.wrong{background:rgba(255,91,91,.12); border-color:rgba(255,91,91,.5)}
    .answers button:disabled{opacity:.95; cursor:not-allowed}

    .audience{margin-top:8px; display:none}
    .bar{height:26px; display:flex; align-items:center; gap:8px; margin:6px 0}
    .bar .label{width:28px; text-align:center; font-weight:900; color:var(--muted)}
    .bar .track{flex:1; background:#0f1533; border:1px solid rgba(255,255,255,.08); border-radius:999px; overflow:hidden}
    .bar .fill{height:100%; background:linear-gradient(90deg, var(--accent), var(--accent-2)); width:0%}
    .bar .pct{width:42px; text-align:right; color:var(--muted); font-weight:800}

    .controls{display:flex; flex-wrap:wrap; align-items:center; justify-content:space-between; gap:8px; margin-top:12px}
    .controls .payout{font-weight:900; color:var(--gold); font-size:clamp(14px,3vw,16px)}

    /* Ladder (desktop) */
    .ladder{padding:clamp(12px,2.4vw,18px); position:sticky; top:calc(8px + var(--safe-top)); max-height:calc(100dvh - 120px); overflow:auto}
    .ladder h3{margin:0 0 10px 0; font-size:clamp(12px,2.4vw,14px); text-transform:uppercase; letter-spacing:.12em; color:#b3c2ff}
    .steps{list-style:none; padding:0; margin:0; display:grid; gap:6px}
    .step{display:flex; justify-content:space-between; background:#0f1533; border:1px solid rgba(255,255,255,.06); border-radius:10px; padding:8px 10px; color:var(--muted); font-weight:800; font-size:clamp(12px,2.4vw,14px)}
    .step .q{opacity:.8}
    .step.active{background:linear-gradient(90deg, rgba(249,200,70,.18), #0f1533); color:var(--ink); border-color:rgba(249,200,70,.5)}
    .step.safe{outline:1px dashed rgba(249,200,70,.6)}

    /* Ladder como "gaveta" no mobile */
    @media (max-width:900px){
      .sub{display:none}
      .ladder{position:fixed; left:0; right:0; bottom:calc(10px + var(--safe-bottom)); max-height:60dvh; width:100%; padding:12px; border-radius:16px;
               transform:translateY(110%); transition:.3s transform; z-index:30; backdrop-filter: blur(6px)}
      .ladder.open{transform:translateY(0%)}
      #ladderToggle{display:inline-flex}
    }
    @media (min-width:901px){ #ladderToggle{display:none} }

    footer{opacity:.9; font-size:12px; color:var(--muted); text-align:center; padding-bottom:calc(4px + var(--safe-bottom))}
    a{color:var(--accent)}
  </style>
</head>
<body>
  <div class="app">
    <header class="card">
      <div class="brand"><div class="logo"><span class="medal">üèÖ</span>Show do Milh√£o ‚Äî Ramos do Cooperativismo</div></div>
      <button id="ladderToggle" aria-expanded="false" aria-controls="ladder">üèÜ Pr√™mios</button>
    </header>

    <div class="layout">
      <section class="play card" aria-live="polite">
        <div class="status">
          <div class="lifelines" role="toolbar" aria-label="Ajudas">
            <button id="fifty" aria-label="Usar 50:50">ü™Ñ 50:50</button>
            <button id="skip" aria-label="Pular quest√£o">‚è≠Ô∏è Pular</button>
            <button id="ask" aria-label="Perguntar aos Universit√°rios">üéì Universit√°rios</button>
          </div>
          <div class="meta"><span id="qpos">Pergunta 1/10</span> ‚Ä¢ Parada segura em <strong>3</strong> e <strong>7</strong></div>
        </div>

        <div id="question" class="question">Carregando‚Ä¶</div>
        <div id="answers" class="answers"></div>

        <div id="audience" class="audience" aria-live="polite">
          <div class="bar"><div class="label">A</div><div class="track"><div class="fill" id="barA"></div></div><div class="pct" id="pctA">0%</div></div>
          <div class="bar"><div class="label">B</div><div class="track"><div class="fill" id="barB"></div></div><div class="pct" id="pctB">0%</div></div>
          <div class="bar"><div class="label">C</div><div class="track"><div class="fill" id="barC"></div></div><div class="pct" id="pctC">0%</div></div>
          <div class="bar"><div class="label">D</div><div class="track"><div class="fill" id="barD"></div></div><div class="pct" id="pctD">0%</div></div>
        </div>

        <div class="controls">
          <div class="payout">Pr√™mio atual: <span id="payout">R$ 0</span></div>
          <div style="display:flex; gap:8px">
            <button id="restart" title="Reiniciar o jogo">üîÑ Recome√ßar</button>
          </div>
        </div>

        <details>
          <summary>Regras e cr√©ditos</summary>
          <div style="margin-top:8px; line-height:1.6; font-size:clamp(12px,2.6vw,14px)">
            ‚Ä¢ 10 perguntas aleat√≥rias, 4 alternativas cada. <br/>
            ‚Ä¢ Ajudas: <strong>50:50</strong> (remove 2 erradas, 1x), <strong>Pular</strong> (troca a quest√£o, 1x), <strong>Universit√°rios</strong> (votos simulados, 1x).<br/>
            ‚Ä¢ Paradas seguras ao acertar as perguntas <strong>3</strong> e <strong>7</strong>.<br/>
            ‚Ä¢ Pr√™mio m√°ximo: <strong>R$ 1.000.000</strong> (Show do Milh√£o).<br/>
            ‚Ä¢ Conte√∫do baseado na Resolu√ß√£o OCB n¬∫ 56/2019 e descri√ß√£o dos ramos do cooperativismo.
          </div>
        </details>
      </section>

      <aside id="ladder" class="ladder card" aria-hidden="true" aria-label="Tabela de pr√™mios">
        <h3>Tabela de pr√™mios</h3>
        <ol id="ladderList" class="steps"></ol>
      </aside>
    </div>

    <footer>Feito com ‚ù§Ô∏è para aulas de Cooperativismo.</footer>
  </div>

  <script>
  // ======= Base de dados: 7 Ramos (OCB 56/2019) =======
  const DATA = [
    {
      ramo: "Agropecu√°rio",
      definicao: "Prover, por meio da mutualidade, servi√ßos relacionados √†s atividades agropecu√°ria, extrativista, agroindustrial, aqu√≠cola ou pesqueira, cujos cooperados det√™m meios de produ√ß√£o.",
      pontos: [
        "Cooperados det√™m meios de produ√ß√£o",
        "Assist√™ncia t√©cnica e fomento √† tecnologia",
        "Agrega valor na compra de insumos, classifica√ß√£o, armazenagem, processamento e comercializa√ß√£o",
        "Hist√≥rico de organiza√ß√£o desde 1847"
      ],
      atividades: ["Compra de insumos", "Classifica√ß√£o e armazenagem", "Agroind√∫stria", "Comercializa√ß√£o conjunta", "Aquicultura/Pesca"]
    },
    {
      ramo: "Consumo",
      definicao: "Compra em comum de produtos e/ou servi√ßos para os cooperados por meio da mutualidade.",
      pontos: [
        "Dois tipos: cooperativa fechada (v√≠nculo comum) e aberta (qualquer pessoa)",
        "Passa a englobar parte do Educacional (pais/alunos) e Turismo e Lazer (aquisi√ß√£o de servi√ßos tur√≠sticos via cooperativa)"
      ],
      atividades: ["Centrais de compras", "Benef√≠cios e conv√™nios", "Turismo mediado pela cooperativa"]
    },
    {
      ramo: "Cr√©dito",
      definicao: "Presta√ß√£o de servi√ßos financeiros aos cooperados, com acesso a instrumentos do mercado financeiro.",
      pontos: [
        "Reguladas pelo Banco Central do Brasil",
        "Oferecem cart√£o, financiamento, cons√≥rcio, previd√™ncia, etc.",
        "Taxas, tarifas e prazos mais adequados √† realidade dos cooperados",
        "Em v√°rios munic√≠pios s√£o a √∫nica alternativa de servi√ßos financeiros"
      ],
      atividades: ["Conta corrente", "Cr√©dito e financiamento", "Cons√≥rcios", "Previd√™ncia", "Meios de pagamento"]
    },
    {
      ramo: "Infraestrutura",
      definicao: "Presta√ß√£o de servi√ßos relacionados √† infraestrutura aos cooperados por meio da mutualidade.",
      pontos: [
        "Passa a englobar o Ramo Habitacional",
        "Abrange energia el√©trica, irriga√ß√£o, telefonia/telecom, saneamento, rodovias/ferrovias, constru√ß√£o civil e habita√ß√£o",
        "Leva qualidade de vida e desenvolvimento a regi√µes distantes"
      ],
      atividades: ["Energia el√©trica", "Irriga√ß√£o", "Telefonia/Telecom", "Saneamento", "Habita√ß√£o", "Obras vi√°rias"]
    },
    {
      ramo: "Trabalho, Produ√ß√£o de Bens e Servi√ßos",
      definicao: "Organizar a presta√ß√£o de servi√ßos especializados a terceiros ou a produ√ß√£o em comum de bens.",
      pontos: [
        "Re√∫ne e ressignifica os antigos ramos Trabalho, Produ√ß√£o, Mineral, Especial e partes de Turismo/Lazer e Educacional",
        "Caminho para profissionais empreendedores se tornarem donos do pr√≥prio neg√≥cio",
        "Lei 12.690/2012 pode ou n√£o incidir conforme objeto e opera√ß√µes (n√£o √© autom√°tica)"
      ],
      atividades: ["Servi√ßos profissionais", "Produ√ß√£o industrial e artesanal", "Terceiriza√ß√£o especializada", "Projetos e manuten√ß√£o"]
    },
    {
      ramo: "Sa√∫de",
      definicao: "Prover ou adquirir servi√ßos dedicados √† preserva√ß√£o, assist√™ncia e promo√ß√£o da sa√∫de humana.",
      pontos: [
        "Constitu√≠das por profissionais de sa√∫de ou usu√°rios",
        "Inclui m√©dicas, odontol√≥gicas, psicol√≥gicas e cooperativas de usu√°rios (planos de sa√∫de)",
        "Atua√ß√£o tamb√©m junto ao setor p√∫blico via parcerias"
      ],
      atividades: ["Atendimento m√©dico", "Odontologia", "Psicologia", "Planos/operadoras de sa√∫de", "Parcerias SUS/gest√µes p√∫blicas"]
    },
    {
      ramo: "Transporte",
      definicao: "Organizar a presta√ß√£o de servi√ßos de transporte de cargas e/ou passageiros, com posse ou propriedade do ve√≠culo pelos cooperados.",
      pontos: [
        "Exige posse ou propriedade do(s) ve√≠culo(s) pelos cooperados",
        "Engloba parte do Turismo e Lazer",
        "Modalidades: individual, coletivo e cargas",
        "Visa organiza√ß√£o, profissionaliza√ß√£o e liberdade de pequenos e m√©dios transportadores"
      ],
      atividades: ["T√°xi/Motorista aut√¥nomo", "Vans/√înibus", "Motofrete", "Transporte de cargas", "Escolar/Tur√≠stico"]
    }
  ];

  // ======= Utilidades =======
  const shuffle = arr => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(v=>v[1]);
  const sample = (arr,n) => shuffle(arr).slice(0,n);
  const currency = n => n.toLocaleString('pt-BR',{style:'currency', currency:'BRL'});

  // ======= Configura√ß√£o do jogo (10 perguntas; pr√™mio final R$ 1.000.000) =======
  const PRIZES = [1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];
  const SAFE_STOPS = [3, 7];
  const TOTAL_Q = 10;

  let state;

  function initState(){
    state = { qIndex: 0, prizeIndex: -1, lastSafe: -1, used:{ fifty:false, skip:false, ask:false }, current:null };
  }

  // ======= Tipos de quest√£o =======
  const TYPES = [
    "DEF_TO_RAMO",
    "RAMO_TO_DEF",
    "ATIV_TO_RAMO",
    "FACT_TO_RAMO",
    "QUEST_ESPECIFICA"
  ];

  function outrasOpcoes(ramoCorreto){
    return sample(DATA.filter(d=>d.ramo!==ramoCorreto).map(d=>d.ramo), 3);
  }

  function makeQuestion(){
    const qType = TYPES[Math.floor(Math.random()*TYPES.length)];
    const el = DATA[Math.floor(Math.random()*DATA.length)];

    let prompt, options, correctIndex, meta = "";

    if(qType === "DEF_TO_RAMO"){
      prompt = `A qual ramo do cooperativismo pertence a seguinte defini√ß√£o?\n‚Äú${el.definicao}‚Äù`;
      options = shuffle([el.ramo, ...outrasOpcoes(el.ramo)]);
      correctIndex = options.indexOf(el.ramo);
      meta = "Classifica√ß√£o oficial (OCB 56/2019)";
    }
    else if(qType === "RAMO_TO_DEF"){
      const erradas = sample(DATA.filter(d=>d!==el).map(d=>d.definicao), 3);
      options = shuffle([el.definicao, ...erradas]);
      prompt = `Qual √© a melhor descri√ß√£o para o ramo: ${el.ramo}?`;
      correctIndex = options.indexOf(el.definicao);
      meta = "Defini√ß√£o do ramo";
    }
    else if(qType === "ATIV_TO_RAMO"){
      const pistas = sample(el.atividades, Math.min(3, el.atividades.length)).join(" ‚Ä¢ ");
      prompt = `Essas atividades/servi√ßos est√£o mais associadas a qual ramo?\n‚Äú${pistas}‚Äù`;
      options = shuffle([el.ramo, ...outrasOpcoes(el.ramo)]);
      correctIndex = options.indexOf(el.ramo);
      meta = "Atividades t√≠picas do ramo";
    }
    else if(qType === "FACT_TO_RAMO"){
      const pista = el.pontos[Math.floor(Math.random()*el.pontos.length)];
      prompt = `O fato/pista abaixo caracteriza principalmente qual ramo?\n‚Äú${pista}‚Äù`;
      options = shuffle([el.ramo, ...outrasOpcoes(el.ramo)]);
      correctIndex = options.indexOf(el.ramo);
      meta = "Pista tem√°tica do ramo";
    }
    else if(qType === "QUEST_ESPECIFICA"){
      const especificas = [];
      especificas.push({
        prompt: "Qual ramo possui cooperativas reguladas pelo Banco Central do Brasil e oferece servi√ßos como cart√£o, financiamento e previd√™ncia?",
        answer: "Cr√©dito"
      });
      especificas.push({
        prompt: "Qual ramo exige, expressamente, que os cooperados detenham a posse ou a propriedade do(s) ve√≠culo(s)?",
        answer: "Transporte"
      });
      especificas.push({
        prompt: "Em qual ramo existem cooperativas do tipo aberta e fechada e que passou a englobar parte das cooperativas Educacionais (pais/alunos) e de Turismo/Lazer (aquisi√ß√£o de servi√ßos)?",
        answer: "Consumo"
      });
      especificas.push({
        prompt: "Qual ramo passou a englobar o Habitacional e atua com energia el√©trica, irriga√ß√£o, telefonia/telecom, saneamento, rodovias/ferrovias e constru√ß√£o/habita√ß√£o?",
        answer: "Infraestrutura"
      });
      especificas.push({
        prompt: "Qual ramo organiza servi√ßos especializados a terceiros ou produ√ß√£o em comum de bens, somando antigos ramos (Trabalho, Produ√ß√£o, Mineral, Especial) e podendo ter incid√™ncia da Lei 12.690/2012 conforme o objeto?",
        answer: "Trabalho, Produ√ß√£o de Bens e Servi√ßos"
      });
      especificas.push({
        prompt: "Qual ramo re√∫ne cooperativas de profissionais de sa√∫de e de usu√°rios (planos), atuando em √°reas como m√©dica, odontol√≥gica e psicol√≥gica?",
        answer: "Sa√∫de"
      });
      especificas.push({
        prompt: "Qual ramo envolve agropecu√°ria, extrativismo, agroind√∫stria, aquicultura e pesca, com cooperados detendo meios de produ√ß√£o e apoio t√©cnico?",
        answer: "Agropecu√°rio"
      });

      const q = especificas[Math.floor(Math.random()*especificas.length)];
      prompt = q.prompt;
      options = shuffle([q.answer, ...outrasOpcoes(q.answer)]);
      correctIndex = options.indexOf(q.answer);
      meta = "Conhecimentos espec√≠ficos do ramo";
    }

    return { prompt, options, correctIndex, meta };
  }

  // ======= Renderiza√ß√£o =======
  const qEl = document.getElementById('question');
  const aWrap = document.getElementById('answers');
  const qPos = document.getElementById('qpos');
  const payoutEl = document.getElementById('payout');
  const ladderEl = document.getElementById('ladderList');
  const ladderAside = document.getElementById('ladder');
  const ladderToggle = document.getElementById('ladderToggle');

  function buildLadder(){
    ladderEl.innerHTML = '';
    for(let i=PRIZES.length-1; i>=0; i--){
      const li = document.createElement('li');
      li.className = 'step';
      li.dataset.index = i;
      const stepNo = (i+1).toString().padStart(2,'0');
      li.innerHTML = `<span class="q">${stepNo}</span><span>${currency(PRIZES[i])}</span>`;
      if(SAFE_STOPS.includes(i+1)) li.classList.add('safe');
      ladderEl.appendChild(li);
    }
  }

  function highlightLadder(){
    const items = ladderEl.querySelectorAll('.step');
    items.forEach(el=>el.classList.remove('active'));
    const current = ladderEl.querySelector(`.step[data-index="${state.prizeIndex}"]`);
    if(current) current.classList.add('active');
  }

  function renderQuestion(){
    state.current = makeQuestion();
    const {prompt, options, correctIndex, meta} = state.current;

    qEl.textContent = prompt;
    const metaDiv = document.createElement('div');
    metaDiv.className = 'meta';
    metaDiv.textContent = meta;
    qEl.appendChild(metaDiv);

    aWrap.innerHTML = '';
    const letters = ['A','B','C','D'];
    options.forEach((opt,idx)=>{
      const btn = document.createElement('button');
      btn.innerHTML = `<span class="badge">${letters[idx]}</span> <span>${opt}</span>`;
      btn.addEventListener('click', ()=>selectAnswer(idx, btn));
      aWrap.appendChild(btn);
    });

    document.getElementById('audience').style.display = 'none';
    ['A','B','C','D'].forEach(L=>{
      document.getElementById('bar'+L).style.width = '0%';
      document.getElementById('pct'+L).textContent = '0%';
    });

    qPos.textContent = `Pergunta ${state.qIndex+1}/${TOTAL_Q}`;
  }

  function selectAnswer(idx, btn){
    const buttons = Array.from(aWrap.querySelectorAll('button'));
    buttons.forEach(b=>b.disabled = true);

    const isCorrect = idx === state.current.correctIndex;
    if(isCorrect){
      btn.classList.add('correct');
      state.qIndex++;
      state.prizeIndex++;
      highlightLadder();
      payoutEl.textContent = currency(PRIZES[Math.max(0, state.prizeIndex)] || 0);
      if(SAFE_STOPS.includes(state.qIndex)) state.lastSafe = state.prizeIndex;

      setTimeout(()=>{
        if(state.qIndex >= TOTAL_Q){ endGame(true); }
        else { renderQuestion(); }
      }, 700);
    } else {
      btn.classList.add('wrong');
      const correctBtn = buttons[state.current.correctIndex];
      if(correctBtn) correctBtn.classList.add('correct');
      setTimeout(()=>endGame(false), 850);
    }
  }

  function endGame(won){
    aWrap.querySelectorAll('button').forEach(b=>b.disabled = true);
    const earned = won ? PRIZES[PRIZES.length-1] : (state.lastSafe>=0 ? PRIZES[state.lastSafe] : 0);
    qEl.innerHTML = won
      ? `üéâ <strong>Parab√©ns!</strong> Voc√™ venceu o Show do Milh√£o!<div class="meta">Pr√™mio final: ${currency(earned)}</div>`
      : `üí° <strong>Fim de jogo.</strong> Voc√™ leva: ${currency(earned)} <div class="meta">Tente novamente para alcan√ßar o milh√£o!</div>`;
  }

  // ======= Ajudas =======
  const btn50 = document.getElementById('fifty');
  const btnSkip = document.getElementById('skip');
  const btnAsk = document.getElementById('ask');

  btn50.addEventListener('click', ()=>{
    if(state.used.fifty) return; state.used.fifty = true; btn50.disabled = true;
    const buttons = Array.from(aWrap.querySelectorAll('button'));
    const wrongIdx = [0,1,2,3].filter(i=>i!==state.current.correctIndex);
    shuffle(wrongIdx).slice(0,2).forEach(i=>{ buttons[i].disabled = true; buttons[i].style.opacity = .5; });
  });

  btnSkip.addEventListener('click', ()=>{
    if(state.used.skip) return; state.used.skip = true; btnSkip.disabled = true;
    renderQuestion();
  });

  btnAsk.addEventListener('click', ()=>{
    if(state.used.ask) return; state.used.ask = true; btnAsk.disabled = true;
    const base = [0,0,0,0];
    const correct = state.current.correctIndex;
    let remaining = 100;
    const correctPct = 45 + Math.floor(Math.random()*26);
    base[correct] = correctPct; remaining -= correctPct;
    const others = shuffle([0,1,2,3].filter(i=>i!==correct));
    base[others[0]] = Math.floor(remaining * (30+Math.random()*20)/100);
    remaining -= base[others[0]];
    base[others[1]] = Math.floor(remaining * (50+Math.random()*30)/100);
    remaining -= base[others[1]];
    base[others[2]] = remaining;

    document.getElementById('audience').style.display = 'block';
    const letters = ['A','B','C','D'];
    letters.forEach((L,i)=>{
      const w = base[i];
      document.getElementById('bar'+L).style.width = w+'%';
      document.getElementById('pct'+L).textContent = w+'%';
    });
  });

  // ======= Reiniciar =======
  const btnRestart = document.getElementById('restart'); btnRestart.addEventListener('click', startGame);

  function startGame(){
    initState();
    buildLadder();
    highlightLadder();
    payoutEl.textContent = currency(0);
    [btn50, btnSkip, btnAsk].forEach(b=>{ b.disabled=false; });
    renderQuestion();
  }

  // ======= Toggle ladder (mobile) =======
  ladderToggle.addEventListener('click', ()=>{
    const open = ladderAside.classList.toggle('open');
    ladderAside.setAttribute('aria-hidden', String(!open));
    ladderToggle.setAttribute('aria-expanded', String(open));
  });

  startGame();
  </script>
</body>
</html>
